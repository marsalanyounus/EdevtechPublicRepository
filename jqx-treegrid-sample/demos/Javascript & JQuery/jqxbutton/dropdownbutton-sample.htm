<!DOCTYPE html>
<html lang="en">
<head>
    <title id='Description'>With the jqxDropDownButton, you can display any type of content
        in a popup. </title>
    <link rel="stylesheet" href="../../../jqwidgets/styles/jqx.base.css" type="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1 minimum-scale=1" />	
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/jquery-migrate-3.3.2.js"></script>
	
    <script type="text/javascript" src="../../../scripts/demos.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxcore.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxdropdownbutton.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxscrollbar.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxbuttons.js"></script>
     <script type="text/javascript" src="../../../jqwidgets/jqxdatatable - updated.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxtreegrid.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxpanel.js"></script>
    <script type="text/javascript" src="../../../jqwidgets/jqxcheckbox.js"></script>
	<script type="text/javascript" src="../../../jqwidgets/jqxdata.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            var dropDownTreeTextBox = "#ig-smartReportWindow-report-dropdown-tree-txtBoxrvm-smartReport-dialogdiv";
            var dropDownTreeId = "#ig-smartReportWindow-report-dropdown-tree-rvm-smartReport-dialogdiv";
            var dropDownButtonId = "#ig-smartReportWindow-report-dropdown-button-rvm-smartReport-dialogdiv";

            var jsonString = "[{\"id\":\"-1\",\"text\":\"Default\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Detailed Test plan.xml\",\"text\":\"Detailed Test plan\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Form as table.xml\",\"text\":\"Form as table\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Form with table.xml\",\"text\":\"Form with table\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Form.xml\",\"text\":\"Form\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\High level Test plan.xml\",\"text\":\"High level Test plan\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Smart Docs form.xml\",\"text\":\"Smart Docs form\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Smart Docs table.xml\",\"text\":\"Smart Docs table\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Table with links.xml\",\"text\":\"Table with links\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Table.xml\",\"text\":\"Table\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Test Case.xml\",\"text\":\"Test Case\",\"value\":\"IsFile\",\"parentid\":\"-1\",\"isFolder\":false,\"componentName\":null,\"fileType\":\"\"},{\"id\":\"1\",\"text\":\"ReviewManagement\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebReviewManagement\",\"fileType\":\"\"},{\"id\":\"3\",\"text\":\"Baselining\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebBaseline\",\"fileType\":\"\"},{\"id\":\"4\",\"text\":\"Diagram\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebModel\",\"fileType\":\"\"},{\"id\":\"6\",\"text\":\"FAQ\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebQWizard\",\"fileType\":\"\"},{\"id\":\"7\",\"text\":\"Reporting\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebReporting\",\"fileType\":\"\"},{\"id\":\"9\",\"text\":\"Simulation\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebSimulation\",\"fileType\":\"\"},{\"id\":\"10\",\"text\":\"Smart Docs\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebSmartDocs\",\"fileType\":\"\"},{\"id\":\"11\",\"text\":\"Smart Note\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebSmartNote\",\"fileType\":\"\"},{\"id\":\"12\",\"text\":\"Traceability\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebTraceability\",\"fileType\":\"\"},{\"id\":\"13\",\"text\":\"Usecase\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATWebUsecase\",\"fileType\":\"\"},{\"id\":\"15\",\"text\":\"Backlogs\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATVstsBacklogsSmartReport\",\"fileType\":\"\"},{\"id\":\"16\",\"text\":\"Queries\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATVstsQueriesSmartReport\",\"fileType\":\"\"},{\"id\":\"17\",\"text\":\"Test Plans\",\"value\":\"IsFolder\",\"parentid\":null,\"isFolder\":true,\"componentName\":\"inteGREATVstsTestPlanSmartReport\",\"fileType\":\"\"}]";
            var fileToSelect = "{\"id\":\"C:\\\\Users\\\\Public\\\\Documents\\\\SmartReport Templates\\\\Default\\\\Configuration\\\\Xml\\\\Form.xml\",\"label\":\"\"}";

            var fileToSelect = JSON.parse(fileToSelect);
            var filesInfo = JSON.parse(jsonString);

            if (filesInfo.length > 0) {
                var getLocalization = function () {
                    var localizationobj = {};
                    localizationobj.emptyDataString = "No Result Found.";
                    return localizationobj;
                };
               
                $(dropDownTreeTextBox).val("");
                var filesInfoUpdated = [];
                for (var i = 0; i < filesInfo.length; i++) {
                    if (filesInfo[i].value == "IsFile") {
                        filesInfoUpdated.push({ "id": encodeURI(filesInfo[i].id), "text": filesInfo[i].text, "parentid": filesInfo[i].parentid, "isFile": filesInfo[i].text });
                    } else if (filesInfo[i].value == "IsFolder") {
                        filesInfoUpdated.push({ "id": encodeURI(filesInfo[i].id), "text": filesInfo[i].text, "parentid": filesInfo[i].parentid });
                    }
                }

                var source =
                {
                    dataType: "json",
                    dataFields: [
                        { name: 'id', type: 'string' },
                        { name: 'parentid', type: 'string' },
                        { name: 'text', type: 'string' },
                        { name: 'isFile', type: 'string' }
                    ],
                    hierarchy:
                    {
                        keyDataField: { name: 'id' },
                        parentDataField: { name: 'parentid' }
                    },
                    id: 'id',
                    localData: filesInfoUpdated
                };

                var dataAdapter = new $.jqx.dataAdapter(source);
                dataAdapter.dataBind();

                $(dropDownTreeId).jqxTreeGrid(
                {
                    width: 338,
                    height: 280,
                    source: dataAdapter,
                    showHeader: false,
                    filterable: false,
                    localization: getLocalization(),
                    sortable: true,
                    columns: [
                        { text: 'text', dataField: 'text', width: 320 },
                        { text: 'isFile', dataField: 'isFile', width: 200, hidden: true }
                    ]
                });
                $(dropDownButtonId).jqxDropDownButton({ width: 340, height: 21, animationType: "none" });
                $(dropDownButtonId).jqxDropDownButton('setContent', '<div style="position: relative; margin-left: 3px; margin-top: 4px;"></div>');
                $(dropDownTreeId).jqxTreeGrid('clearFilters');              
                var rows = $(dropDownTreeId).jqxTreeGrid('getRows');               
                setDefaultItemReportFile(rows, fileToSelect, dropDownTreeId, dropDownTreeTextBox);
                //=====================selectedItem is undefined object===========================//
                selectedItem = $(dropDownTreeId).jqxTreeGrid('getSelection');
                //=====================selectedItem is undefined object===========================//
                debugger;
            }

            function setDefaultItemReportFile(items, fileToSelect, dropDownTreeId, dropDownTreeTextBox) {

                if (!items || !items.length || !fileToSelect || (!fileToSelect.label && !fileToSelect.id)) {
                    return;
                }

                var selectedID = decodeUriOrFilePath(fileToSelect.id);

                var findNode = false;
                var traverseTree = function (items) {
                    var itemID = "";

                    for (var i = 0; i < items.length; i++) {

                        if (items[i].isFile) {
                            itemID = decodeUriOrFilePath(items[i].id);

                            if (selectedID && itemID.toLowerCase() == selectedID.toLowerCase()) {
                                findNode = true;
                            } else if (items[i].text == fileToSelect.label) {
                                findNode = true;
                            }
                        }

                        if (findNode) {
                            $(dropDownTreeId).jqxTreeGrid('selectRow', items[i].id);
                            $(dropDownTreeId).jqxTreeGrid('expandRow', items[i].parent.id);
                            $(dropDownTreeId).attr("dropdownLastSelection", items[i].id);

                            $(dropDownTreeTextBox).val(items[i].text);

                            break;
                        } else if (items[i].records) {
                            traverseTree(items[i].records);
                            if (findNode) {
                                break;
                            }
                        }
                    }
                };
                traverseTree(items);
            }

            function decodeUriOrFilePath(uri) {
                if (!uri) {
                    return uri;
                }
                var decodedUri = "";
                try {
                    decodedUri = decodeURI(uri);
                }
                catch (e) {
                    decodedUri = uri;
                }
                return decodedUri;
            }
        });
    </script>
</head>
<body class='default'>
     <div style="display: table-cell; position: relative; top: 5px; width: 345px;">
                        <div id="ig-smartReportWindow-report-dropdown-button-rvm-smartReport-dialogdiv" style="background-color: white;  border: none;">
                            <div id="ig-smartReportWindow-report-dropdown-tree-rvm-smartReport-dialogdiv" class="ig-smartReport-jqxTreeGrid" style="overflow-y: auto;overflow-x: hidden  ">
                            </div>
                        </div>
                        <div style="width: 345px;">
                            <input type="text" id="ig-smartReportWindow-report-dropdown-tree-txtBoxrvm-smartReport-dialogdiv" style="width: 315px; height: 18px; font-size: 12px; border: none; position: absolute; top: 16px; left: 2px;outline: none" />
                        </div>
                    </div>
</body>
</html>
